/* (C)2014 Peter Cook prcweb.co.uk */"use strict";!function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.bar=function(){function a(){}function b(a,b){a=g.accessor(a);var c,d,e,f,h=j?j:k[b];"horizontal"===g.orientation?(c=b*g.transform.x,d=b*g.transform.y,e=0,isNaN(a)||(e=Math.abs(h(a))),0>a&&(c-=e),f=g.barWidth):(c=b*g.transform.x,f=Math.abs(h(0)-h(a)),e=g.barWidth,d=h(0),a>0&&(d-=f),d+=b*g.transform.y),d3.select(this).attr("x",c).attr("y",d).attr("width",e).attr("height",f)}function c(a,b){var c,d,e;"horizontal"===g.orientation&&(c=b*g.transform.x+("right"===g.valueSide?3:-3),d=b*g.transform.y+.5*(g.barWidth+.8*g.valueLabelSize),e="right"===g.valueSize?"start":"end"),d3.select(this).attr("x",c).attr("y",d).style("text-anchor",e)}function d(){g.domain?j=d3.scale.linear().domain(g.domain).range(g.range):g.domains&&(k=_.map(g.domains,function(a){return d3.scale.linear().domain(a).range(g.range)}));var a=l.container.selectAll("rect").data(h);a.enter().append("rect"),a.exit().remove(),a.each(b).style("fill",function(a){return g.signColors?a>0?g.signColors[1]:g.signColors[0]:g.color?g.color:""}),g.showValues&&e()}function e(){var a=l.container.selectAll("text.value-label").data(h);a.enter().append("text").classed("value-label",!0).style("font-size",g.valueLabelSize+"px").text(function(a){return a}),a.exit().remove(),a.each(c)}function f(b){l.container=d3.select(b[0][0]),h=g.datumAccessor(l.container.datum()),i||a(),d(),i=!0}var g={datumAccessor:function(a){return a},accessor:function(a){return a},barWidth:10,transform:{x:11,y:0},orientation:"vertical",domain:null,domains:null,range:[-50,50],showValues:!1,valueSide:"right",valueLabelSize:10,signColors:null,color:null},h=null,i=!1,j=null,k=null,l={container:null,bars:null};return d3.keys(g).forEach(function(a){f[a]=function(b){return arguments.length?(g[a]=b,f):g[a]}}),f}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.connectedLabels=function(){function b(a){var b=d3.select(this).selectAll("span.label").data(function(a){return a.labels}).enter().append("span");b.append("span").attr("class",function(b,c){return a.classes?a.classes[c]:""}).classed("label",!0).text(function(a){return a}),b.append("span").text(", ")}function c(a){j.container=d3.select(a[0][0]),j.svg=j.container.select(g.connectorContainer),i=j.container.datum()}function d(b){var c=a.svg.pathAbsMove(b.labelPosition.x,b.labelPosition.y);return c+=a.svg.pathAbsLine(b.position.x,b.labelPosition.y),c+=a.svg.pathAbsLine(b.position.x,b.position.y)}function e(){j.container.selectAll("div.label-group").remove(),j.svg.selectAll("path.connector").remove();var a=+j.container.style("width").replace("px",""),c=j.container.selectAll("div.label-group").data(i).enter().append("div").style("position","absolute").style("left",function(a){return"left"===a.connectorSide?a.labelPosition.x+"px":null}).style("right",function(b){return"right"===b.connectorSide?a-b.labelPosition.x+"px":null}).style("top",function(a){return a.labelPosition.y-.5*g.fontSize+"px"}).style("font-size",g.fontSize+"px").attr("class",function(a,b){return"label-group group-"+b});c.each(b),c.selectAll("span:last-child span:last-child").remove(),j.svg.selectAll("path.connector").data(function(a){return a}).enter().append("path").attr("class",function(a,b){var c=[];return c.push("label-group"),c.push("group-"+b),a.classes&&(c=_.union(c,a.classes)),c.join(" ")}).classed("connector",!0).style("fill","none").attr("d",d)}function f(a){c(a),e(),h=!0}var g={fontSize:12,position:{x:0,y:0},connectorContainer:null},h=!1,i=null,j={container:null,groups:null,svg:null,divLayer:null,labelContainer:null};return d3.keys(g).forEach(function(a){f[a]=function(b){return arguments.length?(g[a]=b,f):g[a]}}),f}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.groupedBar=function(){function a(){k=d3.scale.linear().domain(f.domain).range([f.range[1],f.range[0]])}function b(a,b,c){a=f.accessor(a);var d=b*f.transform.x+i[c],e=b*f.transform.y,g=0,l=0;g=h[c],l=Math.abs(k(0)-k(a)),e=k(a>0?a:0),d3.select(this).transition().duration(j?f.transitionDuration:0).attr("x",d).attr("y",e).attr("width",g).attr("height",l)}function c(){a();var c=l.container.selectAll("g.layer").data(g);c.enter().append("g").classed("layer",!0),c.exit().remove();var d=c.selectAll("rect").data(function(a){return a});d.enter().append("rect").style("fill",function(a,b,c){var d=f.colors.length;return f.colors[c%d]}),d.exit().remove(),d.each(b)}function d(){f.seriesVisible||(f.seriesVisible=_.map(g,function(){return!0}));var a=_.filter(f.seriesVisible,function(a){return a}).length,b=f.groupWidth/a;h=[],i=[];var c=0;_.each(g,function(a,d){var e=f.seriesVisible[d]?b:0;h.push(e),i.push(c),c+=e})}function e(a){l.container=d3.select(a[0][0]),g=f.datumAccessor(l.container.datum()),d(),c(),j=!0}var f={accessor:function(a){return a},datumAccessor:function(a){return a},groupWidth:10,transform:{x:11,y:0},domain:null,range:[-50,50],colors:["steelblue","indianred"],seriesVisible:null,transitionDuration:500},g=null,h=[],i=[],j=!1,k=null,l={container:null,bars:null};return d3.keys(f).forEach(function(a){e[a]=function(b){return arguments.length?(f[a]=b,e):f[a]}}),e}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.layerMenu=function(){function a(a){h.container=d3.select(a[0][0]),i.selectedLayer=g.items[g.initialSelection].layerSelector}function b(){h.container.selectAll("div.item").data(g.items).enter().append("div").classed("item",!0).style("cursor","pointer").append("div").style("display","table").append("p").style("display","table-cell").style("text-align","center").style("vertical-align","middle").text(function(a){return a.label})}function c(){b()}function d(){h.container.selectAll("div.item").on("click",function(a){i.selectedLayer=a.layerSelector,e()})}function e(){g.items.forEach(function(a){var b=a.layerSelector,c=b===i.selectedLayer;c?d3.select(b).style("display","block").transition().duration(g.transitionDuration).style("opacity",1):d3.select(b).transition().duration(g.transitionDuration).style("opacity",0).each("end",function(){d3.select(this).style("display","none")})}),h.container.selectAll("div.item").classed("selected",function(a){return a.layerSelector===i.selectedLayer})}function f(b){a(b),c(),d(),e()}var g={items:[],transitionDuration:500,initialSelection:0},h={container:null},i={selectedLayer:0};return d3.keys(g).forEach(function(a){f[a]=function(b){return arguments.length?(g[a]=b,f):g[a]}}),f}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.legend=function(){function a(){f.status||(f.status=_.map(h,function(){return!0})),j=f.status}function b(){var a=i.container.selectAll("div.item").data(h);a.enter().append("div").classed("item",!0).classed("selected",function(a,b){return j[b]}).style("float","left").style("border-left",function(){var a=f.size+"px ";return a+="solid "}).style("font-size",f.size+"px").style("padding-left","5px").style("margin-right","15px").style("cursor","pointer").on("click",function(a,b){var c=d3.select(this),e=c.classed("selected");c.classed("selected",!e),j[b]=!e,d(),f.clickEvent&&f.dispatch[f.clickEvent](a.id),f.changeEvent&&f.dispatch[f.changeEvent](j)}).each(c),a.text(function(a){return a.label}),d()}function c(){d3.select(this).style({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"})}function d(){i.container.selectAll("div.item").style("border-left-color",function(a,b){var c=j[b]?a.color:"#ddd";return c})}function e(c){i.container=d3.select(c[0][0]),h=i.container.datum(),g||a(),b(),g=!0}var f={size:14,dispatch:null,clickEvent:"",changeEvent:"",status:null},g=!1,h=null,i={container:null},j=[];return d3.keys(f).forEach(function(a){e[a]=function(b){return arguments.length?(f[a]=b,e):f[a]}}),e}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.line=function(){function a(){}function b(){h=d3.scale.linear().domain(e.domain).range([e.range[1],e.range[0]])}function c(){b();var a=d3.svg.line().x(function(a,b){return b*e.xStep}).y(function(a){return h(a)}),c=i.container.selectAll("path.series").data(f);c.enter().append("path").classed("series",!0).style("fill","none").style("stroke",function(a,b){var c=e.colors.length;return e.colors[b%c]}).style("opacity",function(a,b){return e.seriesVisible?e.seriesVisible[b]?1:0:1}),c.exit().remove(),c.attr("d",a).transition().style("opacity",function(a,b){return e.seriesVisible?e.seriesVisible[b]?1:0:1})}function d(b){i.container=d3.select(b[0][0]),f=e.datumAccessor(i.container.datum()),g||a(),c(),g=!0}var e={datumAccessor:function(a){return a},xStep:10,domain:[-10,10],range:[-50,50],colors:["steelblue","indianred"],seriesVisible:null,transitionDuration:500},f=null,g=!1,h=null,i={container:null,bars:null};return d3.keys(e).forEach(function(a){d[a]=function(b){return arguments.length?(e[a]=b,d):e[a]}}),d}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.lineTooltip=function(){function a(a){k.container=d3.select(a[0][0]),n=k.container.datum(),k.tooltip=k.container.select("div.tooltip"),o=d3.scale.linear().domain([0,n[0].length-1]).range([0,(n[0].length-1)*j.xStep]),p=d3.scale.linear().domain(j.domain).range([j.range[1],j.range[0]]),b(),c()}function b(){k.tooltip=k.container.append("div").classed("tooltip",!0).style("position","absolute").style("opacity",0).style("width",j.width+"px"),k.tooltip.selectAll("div").data(n).enter().append("div").style("color",function(a,b){return j.colors?j.colors[b]:"black"})}function c(){k.markers=k.container.select("svg").append("g").classed("markers",!0),k.markers.selectAll("circle").data(n).enter().append("circle").attr("r",3).style("fill","none").style("stroke",function(a,b){return j.colors[b]}).style("stroke-width","1px"),k.markers.append("line").attr("y1",p.range()[0]).attr("y2",p.range()[1])}function d(){k.container.on("mousemove.tooltipComponent",function(){f(),g(),h(),e()}),k.container.on("mouseover.tooltipComponent",function(){f(),h(),e()}).on("mouseout.tooltipComponent",function(){l.i=null,e()})}function e(){k.tooltip.transition().style("opacity",null===l.i?0:1),k.markers.transition().style("opacity",null===l.i?0:1)}function f(){var a=k.container[0][0],b=d3.mouse(a);if(l.i=Math.round(o.invert(b[0]-j.svgOffset.x)),l.i<0||l.i>=n[0].length)return l.i=null,void e();var c=o(l.i)+j.offset.x+j.svgOffset.x,d=a.clientWidth;if(c>.5*d){var f=k.tooltip[0][0].clientWidth;c-=f+2*j.offset.x}k.tooltip.style("left",c+"px").style("top",j.offset.y+"px")}function g(){null!==l.i&&(k.markers.selectAll("circle").attr("cx",o(l.i)+j.svgOffset.x).attr("cy",function(a,b){return p(n[b][l.i])}).style("opacity",function(a,b){return null===j.seriesVisible?1:j.seriesVisible[b]?1:0}),k.markers.select("line").attr("x1",o(l.i)+j.svgOffset.x).attr("x2",o(l.i)+j.svgOffset.x))}function h(){null!==l.i&&k.tooltip.selectAll("div").style("display",function(a,b){return null===j.seriesVisible?"block":j.seriesVisible[b]?"block":"none"}).html(function(a,b){var c=j.seriesNames[b]+": ";return c+=a[l.i],c+=j.unit})}function i(b){m||a(b),d(),g(),h(),m=!0}var j={svgOffset:{x:0,y:0},offset:{x:10,y:10},width:200,xStep:150,domain:[-10,10],range:[0,400],colors:null,seriesNames:[],seriesVisible:null,unit:""},k={container:null,tooltip:null,marker:null},l={i:null},m=!1,n=null,o=null,p=null;return d3.keys(j).forEach(function(a){i[a]=function(b){return arguments.length?(j[a]=b,i):j[a]}}),i}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.multiLine=function(){function a(){}function b(){_.each(e.domains,function(a){var b=d3.scale.linear().domain(a).range([e.range[1],e.range[0]]);h.push(b)})}function c(){b();var a=[];_.each(h,function(b,c){var d=d3.svg.line().x(function(a,b){return b*e.xStep}).y(function(a){return h[c](a)});a.push(d)});var c=i.container.selectAll("path.series").data(f);c.enter().append("path").classed("series",!0).style("fill","none").style("stroke",function(a,b){var c=e.colors.length;return e.colors[b%c]}).style("opacity",function(a,b){return e.seriesVisible?e.seriesVisible[b]?1:0:1}),c.exit().remove(),c.attr("d",function(b,c){return a[c](b)}).transition().style("opacity",function(a,b){return e.seriesVisible?e.seriesVisible[b]?1:0:1})}function d(b){i.container=d3.select(b[0][0]),f=e.datumAccessor(i.container.datum()),g||a(),c(),g=!0}var e={datumAccessor:function(a){return a},xStep:10,domains:null,range:[-50,50],colors:["steelblue","indianred"],seriesVisible:null,transitionDuration:500},f=null,g=!1,h=[],i={container:null,bars:null};return d3.keys(e).forEach(function(a){d[a]=function(b){return arguments.length?(e[a]=b,d):e[a]}}),d}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.multiLineTooltip=function(){function b(a){l.container=d3.select(a[0][0]),o=l.container.datum(),l.tooltip=l.container.select("div.tooltip"),p=d3.scale.linear().domain([0,o[0].length-1]).range([0,(o[0].length-1)*k.xStep]),q=[],_.each(k.domains,function(a){var b=d3.scale.linear().domain(a).range([k.range[1],k.range[0]]);q.push(b)}),c(),d()}function c(){l.tooltip=l.container.append("div").classed("tooltip",!0).style("position","absolute").style("opacity",0).style("width",k.width+"px"),l.tooltip.selectAll("div").data(o).enter().append("div").style("color",function(a,b){return k.colors?k.colors[b]:"black"})}function d(){l.markers=l.container.select("svg").append("g").classed("markers",!0),l.markers.selectAll("circle").data(o).enter().append("circle").attr("r",3).style("fill","none").style("stroke",function(a,b){return k.colors[b]}).style("stroke-width","1px"),l.markers.append("line").attr("y1",k.range[0]).attr("y2",k.range[1])}function e(){l.container.on("mousemove.tooltipComponent",function(){g(),h(),i(),f()}),l.container.on("mouseover.tooltipComponent",function(){g(),i(),f()}).on("mouseout.tooltipComponent",function(){m.i=null,f()})}function f(){l.tooltip.transition().style("opacity",null===m.i?0:1),l.markers.transition().style("opacity",null===m.i?0:1)}function g(){var a=l.container[0][0],b=d3.mouse(a);if(m.i=Math.round(p.invert(b[0]-k.svgOffset.x)),m.i<0||m.i>=o[0].length)return m.i=null,void f();var c=p(m.i)+k.offset.x+k.svgOffset.x,d=a.clientWidth;if(c>.5*d){var e=l.tooltip[0][0].clientWidth;c-=e+2*k.offset.x}l.tooltip.style("left",c+"px").style("top",k.offset.y+"px")}function h(){null!==m.i&&(l.markers.selectAll("circle").attr("cx",p(m.i)+k.svgOffset.x).attr("cy",function(a,b){return q[b](o[b][m.i])+k.svgOffset.y}).style("opacity",function(a,b){return null===k.seriesVisible?1:k.seriesVisible[b]?1:0}),l.markers.select("line").attr("transform",a.svg.translate(k.svgOffset.x+p(m.i),k.svgOffset.y)))}function i(){null!==m.i&&l.tooltip.selectAll("div").style("display",function(a,b){return null===k.seriesVisible?"block":k.seriesVisible[b]?"block":"none"}).html(function(a,b){var c='<span class="key">'+k.seriesNames[b]+':</span> <span class="value">';return c+=a[m.i],c+=k.units[b],c+="</span>"})}function j(a){n||b(a),e(),h(),i(),n=!0}var k={svgOffset:{x:0,y:0},offset:{x:10,y:10},width:200,xStep:150,domains:null,range:[0,400],colors:null,seriesNames:[],seriesVisible:null,units:""},l={container:null,tooltip:null,marker:null},m={i:null},n=!1,o=null,p=null,q=null;return d3.keys(k).forEach(function(a){j[a]=function(b){return arguments.length?(k[a]=b,j):k[a]}}),j}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.quartersAxis=function(){function a(){g=function(a){var b=+((a-1)%4+1);return d.justYears&&1!==b?"":"Q"+b}}function b(){var a=d.startQuarter+d.numQuarters;d.centerLabels||a--;for(var b=d3.scale.linear().domain([d.startQuarter,a]).range([0,d.axisLength]),c=[],e=0;e<d.numQuarters;e++)c.push(d.startQuarter+e);var h=d.axisLength/d.numQuarters,i=d3.svg.axis().scale(b).orient("bottom").tickValues(c).tickFormat(g);f.container.call(i),d.centerLabels&&f.container.selectAll(".tick text").attr("x",.5*h);for(var j=[],k=d.startYear,l=d.startQuarter,e=0;e<d.numQuarters;e++)j.push(1===l?k:""),l++,5===l&&(l=1,k++);f.container.selectAll(".tick").append("text").classed("year",!0).attr("x",function(){return d.centerLabels?.5*h:0}).attr("y",32).style("text-anchor","middle").text(function(a,b){return j[b]}),f.container.selectAll("line").style("stroke-width",1).style("shape-rendering","crispEdges").style("stroke",d.lineColor),f.container.selectAll("path").style("stroke-width",1).style("stroke",d.lineColor).style("shape-rendering","crispEdges").style("fill","none"),f.container.selectAll("text").style("font-size",d.fontSize+"px").style("fill",d.labelColor),f.container.selectAll(".tick line").style("stroke-width",function(a){return(a-1)%4===0?3:1})}function c(c){f.container=d3.select(c[0][0]),e||a(),b(),e=!0}var d={axisLength:500,numQuarters:6,startQuarter:null,startYear:null,label:"Label",labelColor:"#666",lineColor:"#aaa",fontSize:11,centerLabels:!0,justYears:!1},e=!1,f={container:null},g=null;return d3.keys(d).forEach(function(a){c[a]=function(b){return arguments.length?(d[a]=b,c):d[a]}}),c}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.stackedBar=function(){function b(){}function c(){l=d3.scale.linear().domain(h.domain).range([h.range[1],h.range[0]])}function d(a,b){var c=b*h.transform.x,d=b*h.transform.y,e=0,f=0;e=h.barWidth,f=Math.abs(l(a.y0)-l(a.y+a.y0)),d=l(a.y>0?a.y0+a.y:a.y0),d3.select(this).transition().duration(k?h.transitionDuration:0).attr("x",c).attr("y",d).attr("width",e).attr("height",f)}function e(){var b=i[0].length,c=a.util.initArray(0,b),d=a.util.initArray(0,b);j=_.map(i,function(a,b){return a=_.map(a,function(a,e){var f=h.accessor(a),g={y:f};return _.extend(g,a),h.seriesVisible&&!h.seriesVisible[b]?(g.y0=f>0?c[e]:d[e],g.y=0,g):(f>0?(g.y0=c[e],c[e]+=f):(g.y0=d[e],d[e]+=f),g)})})}function f(){e(),c();var a=m.container.selectAll("g.layer").data(j);a.enter().append("g").classed("layer",!0),a.exit().remove();var b=a.selectAll("rect").data(function(a){return a});b.enter().append("rect").style("fill",function(a,b,c){var d=h.colors.length;return h.colors[c%d]}),b.exit().remove(),b.each(d)}function g(a){m.container=d3.select(a[0][0]),i=h.datumAccessor(m.container.datum()),k||b(),f(),k=!0}var h={accessor:function(a){return a},datumAccessor:function(a){return a},barWidth:10,transform:{x:11,y:0},domain:null,range:[-50,50],colors:["steelblue","indianred"],seriesVisible:null,transitionDuration:500},i=null,j=null,k=!1,l=null,m={container:null,bars:null};return d3.keys(h).forEach(function(a){g[a]=function(b){return arguments.length?(h[a]=b,g):h[a]}}),g}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.toolTip=function(){function a(a){h.container=d3.select(a[0][0]),h.elements=h.container.selectAll(g.elements?g.elements.join(", "):g.element),h.elements.style("cursor","pointer"),h.tooltip=h.container.select("div.tooltip"),null===h.tooltip[0][0]&&b(),g.template&&(j=g.templateVariableScope?[_.template(g.template,null,{variable:"data"})]:[_.template(g.template)]),g.templates&&(j=g.templateVariableScope?_.map(g.templates,function(a){return _.template(a,null,{variable:"data"})}):_.map(g.templates,function(a){return _.template(a)})),g.elements?_.each(g.elements,function(a,b){h.container.selectAll(a).attr("data-tooltip-template",b)}):h.elements.attr("data-tooltip-template",0)}function b(){h.tooltip=h.container.append("div").classed("tooltip",!0).style("position","absolute").style("opacity",0).style("width",g.width+"px")}function c(){h.container.on("mousemove.tooltipComponent",function(){i.frozen||d()}).on("click.tooltipComponent",function(){i.frozen&&(i.frozen=!1,i.hoverElement=null,h.tooltip.transition().style("opacity","0"),d3.event.stopPropagation())}),h.elements.on("mouseover.tooltipComponent",function(){i.frozen||(i.hoverElement=d3.select(this),h.tooltip.transition().style("opacity","1"),e(),d3.event.stopPropagation())}).on("mouseout.tooltipComponent",function(){i.frozen||(h.tooltip.transition().style("opacity","0"),i.hoverElement=null,d3.event.stopPropagation())}).on("click.tooltipComponent",function(){if(g.freezeOnClick){if(i.frozen&&d3.select(this).classed("tooltip-selected"))return i.hoverElement.classed("tooltip-selected",!1),void(i.frozen=!1);i.frozen=!0,null!==i.hoverElement&&i.hoverElement.classed("tooltip-selected",!1),i.hoverElement=d3.select(this),i.hoverElement.classed("tooltip-selected",!0),d(),e(),d3.event.stopPropagation()}})}function d(){var a=h.container[0][0],b=d3.mouse(a),c=a.clientWidth,d=a.clientHeight;if(i.position.x=b[0]+g.offset.x,i.position.y=b[1]+g.offset.y,b[0]>.5*c){var e=h.tooltip[0][0].clientWidth;i.position.x-=e+2*g.offset.x}if(b[1]>.5*d){var f=h.tooltip[0][0].clientHeight;i.position.y-=f+2*g.offset.y}h.tooltip.style("left",i.position.x+"px").style("top",i.position.y+"px")}function e(){var a=i.hoverElement.datum();if(h.tooltip.html(""),g.templateFunc)h.tooltip.html(g.templateFunc(a));else if(j){var b=i.hoverElement.attr("data-tooltip-template");h.tooltip.html(j[b](a))}else{var c=d3.map(a),d=g.title;if(c.has(g.title)&&(d=a[g.title]),h.tooltip.append("h1").text(d),g.fields){var e=h.tooltip.append("table").selectAll("tr").data(g.fields).enter().append("tr");e.append("td").text(function(a){return a}),e.append("td").text(function(b){return a[b]})}}}function f(b){a(b),c()}var g={element:null,elements:null,offset:{x:10,y:10},template:null,templates:null,templateFunc:null,title:null,fields:null,freezeOnClick:!1,templateVariableScope:!1,width:200},h={container:null,elements:null,tooltip:null},i={position:{x:0,y:0},hoverElement:null,frozen:!1},j=null;return d3.keys(g).forEach(function(a){f[a]=function(b){return arguments.length?(g[a]=b,f):g[a]}}),f}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.treeMap=function(){function a(){j.treeMaps=j.container.selectAll("div.treemap").data(h).enter().append("div").classed("treemap",!0).style("position","absolute")}function b(a){var b=2*f.labelPadding,c=a.dx>b&&a.dy>b+f.labelSize,d=a.dx-f.padding,e=a.dy-f.padding,g=0;c&&(d-=b,e-=b,g=f.labelPadding),d3.select(this).style("left",a.x+"px").style("top",a.y+"px").style("width",d+"px").style("height",e+"px").style("padding",g+"px")}function c(a,c){var d=d3.select(this).selectAll("div.node").data(i[c].nodes,function(a){return a.name}),e=d.enter().append("div").classed("node",!0);e.on("mouseover",function(){var a=d3.select(this).style("background-color"),b=d3.select(this);this.__data__.originalColor=a;var c=d3.rgb(a).brighter(.4).toString();b.style("background-color",c)}).on("mouseout",function(){var a=(d3.select(this),this.__data__.originalColor);d3.select(this).style("background-color",a)}),e.append("p").style("display","table-cell").style("vertical-align","middle").style("text-align","center").style("font-size",f.labelSize+"px"),d.exit().remove(),d.style("display",function(a,b){return 0===b?"none":"table"}).style("background-color",function(a,b){return f.color(a,b)}).style("position","absolute").each(b),d.select("p").html(function(a){return f.labels?f.labelData(a):""}),d.select("p").html(function(a){var b=this.clientHeight+2*f.labelPadding+f.padding,c=this.clientWidth+2*f.labelPadding+f.padding;return b>a.dy||c>a.dx?"":f.labels?f.labelData(a):""})}function d(){i=_.map(h,function(a,b){return d3.layout.treemap().size([void 0===f.width.length?f.width:f.width[b],void 0===f.height.length?f.height:f.height[b]]).padding(f.padding).value(f.value)}),j.treeMaps.each(c)}function e(b){j.container=d3.select(b[0][0]),h=j.container.datum(),g||a(),d(),g=!0}var f={color:function(a,b){return["indianred","steelblue"][b%2]},width:200,height:200,labels:!0,labelSize:10,labelPadding:10,labelData:function(a){return a.name},padding:0,value:function(a){return a.size},sticky:!1},g=!1,h=null,i=null,j={container:null,treeMaps:null};return d3.keys(f).forEach(function(a){e[a]=function(b){return arguments.length?(f[a]=b,e):f[a]}}),e}}(),function(){var a=window.animdata||{};window.animdata=a,a.d3=a.d3||{},a.d3.yearsAxis=function(){function a(){g=function(a){return a}}function b(){var a=d.startYear+d.numYears;d.centerLabels||a--;for(var b=d3.scale.linear().domain([d.startYear,a]).range([0,d.axisLength]),c=[],e=0;e<d.numYears;e++)c.push(d.startYear+e);var h=d.axisLength/d.numYears,i=d3.svg.axis().scale(b).orient("bottom").tickValues(c).tickFormat(g);f.container.call(i),d.centerLabels&&f.container.selectAll(".tick text").attr("x",.5*h),f.container.selectAll("line").style("stroke-width",1).style("shape-rendering","crispEdges").style("stroke",d.lineColor),f.container.selectAll("path").style("stroke-width",1).style("stroke",d.lineColor).style("shape-rendering","crispEdges").style("fill","none"),f.container.selectAll("text").style("font-size",d.fontSize+"px").style("fill",d.labelColor)}function c(c){f.container=d3.select(c[0][0]),e||a(),b(),e=!0}var d={axisLength:500,numYears:10,startYear:null,label:"Label",labelColor:"#666",lineColor:"#aaa",fontSize:11,centerLabels:!1},e=!1,f={container:null},g=null;return d3.keys(d).forEach(function(a){c[a]=function(b){return arguments.length?(d[a]=b,c):d[a]}}),c}}();